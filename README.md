ClonOs 19.01 Web Uİ Multiple Vulnerabilities
[TR] ClonOs 19.01 Web arayüzünde uygulama geliştirmede eksiklerden dolayı, yetkisiz kullanıcı(root) parolası degiştirme ve self xss zafiyetine neden olmakta.

[EN] ClonOs 19.01 lack of application development in the Web interface, causing unauthorized user(root) password change and self XSS weakness.


#Self Xss
***
	code clonos.php
	
![](imgs/20191020-150356.png)

[TR] Kaynak kodunu inceledigimde cookiden alınan lang parametresi filtreden geçirilmeden language parametresine atanmış ve index.php den clonos sınıfından getlang fonksiyonu çagrılıp $lang degişkenine atanmış.

[EN]When I examine the source code, the Lang parameter from the cookie is assigned to the language parameter before the filter is passed, and the getlang function is called from the clonos class and assigned to the $lang variable.



	code index.php
	

![](imgs/20191020-151551.png)

[TR]Clonos.php de getLang() fonksiyonuna baktıgımda filtrelenmeden parametre return edilmiş.
[EN]When I look at getlang() in Clonos.php, the parameter is returned without filtering


	code clonos.php

![](imgs/20191020-151424.png)

[TR]İndex.php de yazdırılmış.Yazılan default etiketi kapatırsak alert kodumuz çalışacaktır.
[EN]İndex.php is also printed.If we close the default tag, our alert code will work.


![](imgs/20191020-151131.png)



[Payload]:Cookie: lang=ru.js" type="text/javascript"></script><svg/onload=alsert(1)><script src="

![](imgs/20191020-153932.png)
***
![](imgs/20191020-153200.png)
***
![](imgs/20191020-152138.png)

#[TR] Yetkisiz Erişim
#[EN] Unauthorized Access 

[TR]Uygulamada sunucu tarafında oturum olaylarını araştırdıgımda bu kontrolün php ile yapılmadıgını farkettim.
[EN]When I investigated server-side session events in the application, I realized that this check was not done with php.


![](imgs/20191020-154745.png)

[TR]Login olmayı denediğimde ise user not found hatası alıyordum.(test:test)
[EN]When I tried to Login, I was getting a user not found error.(test:test)

![](imgs/20191020-162024.png)
![](imgs/20191020-161054.png)


[TR]Grep ile hata mesajını araştırdıgımda ilgili fonksiyona ulaştım.userRegisterCheck adlı fonksiyona ait bir hata mesajı idi.
[EN]When I searched for the error message with Grep, i reached the corresponding function.it was an error message for a function called userRegisterCheck.


![](imgs/20191020-161202.png)
![](imgs/20191020-161427.png)

[TR]Fonksiyon nerden çagırılıyor diye baktıgımda ise login() fonksiyonunu buldum, o nerden çagrıldıgına baktıgımda ise clonos sınıfında constructordan mode=login olunca çağrıldıgını farkettim burda dikkatimi çeken bir diger şey oturum yönetimi yok, öyleyse yetkisiz işlemler yapabiliriz.

[EN]When I look at where the function is called, I found the login() function, where it is called when I look at clonos class constructordan mode=login I noticed that the other thing that attracts my attention here is no session management, so we can do unauthorized operations.

![](imgs/20191020-162728.png)

[TR]Html kodlarına baktıgımda sadece bir modal oldugunu gördüm.
[EN]When I looked at the Html code, I found that it was only a modal


![](imgs/20191020-160549.png)

[TR]Sağ tıklayıp login-area elementini sildigimde GUEST kullanıcısı  full yetkiye sahip oluyor.
[EN]When I right-click and delete the login-area element, the GUEST user has full privileges.


![](imgs/20191020-162912.png)
![](imgs/20191020-163215.png)

![](imgs/20191020-183009.png)
